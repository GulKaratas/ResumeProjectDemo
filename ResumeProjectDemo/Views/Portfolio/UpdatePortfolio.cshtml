@model ResumeProjectDemo.Entities.Portfolio
@{
    ViewData["Title"] = "UpdatePortfolio";
    ViewData["ActivePage"] = "Portfolio";
    Layout = "~/Views/AdminLayout/Index.cshtml";
}

<body class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-white min-h-screen">
    <main class="max-w-[1200px] mx-auto px-4 py-8">

        <!-- Success/Error Messages -->
        @if (TempData["Success"] != null)
        {
            <div class="glass-card mb-6 p-4 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 flex items-center gap-3">
                <span class="material-symbols-outlined text-green-600 dark:text-green-400 text-2xl">check_circle</span>
                <p class="text-green-800 dark:text-green-300 font-medium">@TempData["Success"]</p>
            </div>
        }

        @if (TempData["Error"] != null)
        {
            <div class="glass-card mb-6 p-4 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 flex items-center gap-3">
                <span class="material-symbols-outlined text-red-600 dark:text-red-400 text-2xl">error</span>
                <p class="text-red-800 dark:text-red-300 font-medium">@TempData["Error"]</p>
            </div>
        }

        <!-- Back Button -->
        <div class="mb-6">
            <a asp-controller="Portfolio" asp-action="PortfolioList"
               class="inline-flex items-center gap-2 text-slate-600 dark:text-slate-400 hover:text-primary transition-colors group">
                <span class="material-symbols-outlined text-lg transition-transform group-hover:-translate-x-1">arrow_back</span>
                <span class="text-sm font-medium">Listeye Geri Dön</span>
            </a>
        </div>

        <!-- Page Header -->
        <div class="flex flex-wrap justify-between items-end gap-4 mb-8">
            <div class="flex flex-col gap-2">
                <p class="text-slate-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]">
                    Proje Güncelle
                </p>
                <p class="text-slate-500 dark:text-[#92c0c9] text-base font-normal leading-normal">
                    Mevcut proje bilgilerini ve görselini güncelleyin
                </p>
            </div>
        </div>

        <!-- Form Card -->
        <form asp-controller="Portfolio" asp-action="UpdatePortfolio" method="post" enctype="multipart/form-data">
            <div class="glass-card rounded-xl p-6 md:p-8 shadow-2xl">
                
                <input type="hidden" asp-for="PortfolioId" />

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                    
                    <!-- Left Column: Image Preview -->
                    <div class="lg:col-span-5 flex flex-col gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3 px-1">
                                <span class="material-symbols-outlined text-[18px] align-middle mr-1">image</span>
                                Proje Görseli
                            </label>
                            
                            <div class="relative group">
                                <div class="aspect-[4/3] bg-slate-200 dark:bg-slate-800 rounded-xl overflow-hidden border-2 border-slate-300 dark:border-slate-700">
                                    <img id="imagePreview" 
                                         src="@Model.ImageUrl" 
                                         alt="@Model.Title"
                                         class="w-full h-full object-cover" />
                                </div>
                                
                                <div class="absolute inset-0 bg-black/60 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                                    <div class="text-center">
                                        <span class="material-symbols-outlined text-white text-5xl mb-2 block">photo_camera</span>
                                        <p class="text-white text-sm font-semibold">Görseli Değiştir</p>
                                    </div>
                                </div>
                            </div>

                            <p class="text-xs text-slate-500 dark:text-slate-400 mt-2 px-1">
                                <span class="material-symbols-outlined text-[14px] align-middle">info</span>
                                Önerilen boyut: 1200x800px (JPG, PNG)
                            </p>
                        </div>

                        <!-- Upload Section -->
                        <div class="space-y-3">
                            <button type="button"
                                    onclick="document.getElementById('imageFileInput').click()"
                                    class="w-full flex items-center justify-center gap-2 rounded-xl h-12 px-4 bg-gradient-to-r from-primary/10 to-primary/5 hover:from-primary hover:to-primary/80 text-primary hover:text-white border border-primary/30 font-bold transition-all duration-300 hover:shadow-lg hover:shadow-primary/30">
                                <span class="material-symbols-outlined text-[20px]">upload</span>
                                Yeni Görsel Yükle
                            </button>

                            <input type="file"
                                   id="imageFileInput"
                                   name="imageFile"
                                   accept="image/*"
                                   class="hidden" />
                        </div>
                    </div>

                    <!-- Right Column: Form Fields -->
                    <div class="lg:col-span-7 space-y-6">
                        
                        <!-- Project Title -->
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2 px-1">
                                <span class="material-symbols-outlined text-[18px] align-middle mr-1">title</span>
                                Proje Başlığı <span class="text-red-500">*</span>
                            </label>
                            <input type="text" 
                                   asp-for="Title"
                                   required
                                   placeholder="Örn: E-Ticaret Platformu"
                                   class="w-full rounded-lg bg-white dark:bg-surface-dark border-2 border-slate-300 dark:border-[#234248] px-4 py-3 text-slate-900 dark:text-white placeholder:text-slate-400 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" />
                        </div>

                        <!-- Category -->
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2 px-1">
                                <span class="material-symbols-outlined text-[18px] align-middle mr-1">folder</span>
                                Kategori <span class="text-red-500">*</span>
                            </label>
                            <select asp-for="CategoryId"
                                    required
                                    class="w-full rounded-lg bg-white dark:bg-surface-dark border-2 border-slate-300 dark:border-[#234248] px-4 py-3 text-slate-900 dark:text-white focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all appearance-none">
                                <option value="">Kategori Seçin</option>
                                @if (ViewBag.Categories != null)
                                {
                                    @foreach (var cat in ViewBag.Categories)
                                    {
                                        <option value="@cat.CategoryId">@cat.CategoryName</option>
                                    }
                                }
                            </select>
                        </div>

                        <!-- Image URL -->
                        <div>
                            <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2 px-1">
                                <span class="material-symbols-outlined text-[18px] align-middle mr-1">link</span>
                                Görsel URL <span class="text-slate-400 text-xs">(Opsiyonel - URL kullanmak isterseniz)</span>
                            </label>
                            <div class="relative">
                                <span class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-[20px]">http</span>
                                <input type="text" 
                                       asp-for="ImageUrl"
                                       id="imageUrlInput"
                                       placeholder="https://example.com/image.jpg"
                                       class="w-full rounded-lg bg-white dark:bg-surface-dark border-2 border-slate-300 dark:border-[#234248] pl-11 pr-4 py-3 text-slate-900 dark:text-white placeholder:text-slate-400 focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all" />
                            </div>
                            <p class="text-xs text-slate-500 dark:text-slate-400 mt-1 px-1">
                                Dosya yüklemek yerine URL ile görsel ekleyebilirsiniz
                            </p>
                        </div>

                        <!-- Info Box -->
                        <div class="mt-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800">
                            <div class="flex gap-3">
                                <span class="material-symbols-outlined text-blue-600 dark:text-blue-400 text-xl flex-shrink-0">info</span>
                                <div class="text-sm text-blue-800 dark:text-blue-300">
                                    <p class="font-semibold mb-1">Görsel Yükleme Seçenekleri:</p>
                                    <ul class="list-disc list-inside space-y-1 text-xs">
                                        <li>Bilgisayarınızdan dosya yükleyebilirsiniz</li>
                                        <li>Ya da direkt URL adresi girebilirsiniz</li>
                                        <li>İki alan da doluysa URL önceliklidir</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end items-center gap-4 pt-6 mt-8 border-t border-slate-300 dark:border-slate-700">
                    <a asp-action="PortfolioList"
                       class="flex min-w-[100px] items-center justify-center rounded-xl h-11 px-6 border-2 border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-300 font-bold hover:bg-slate-100 dark:hover:bg-slate-800 transition-all">
                        İptal
                    </a>

                    <button type="submit"
                            class="flex min-w-[140px] items-center justify-center gap-2 rounded-xl h-11 px-8 bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary text-white font-bold shadow-lg shadow-primary/30 hover:shadow-xl hover:shadow-primary/40 transition-all hover:-translate-y-0.5">
                        <span class="material-symbols-outlined text-[20px]">save</span>
                        Kaydet
                    </button>
                </div>

            </div>
        </form>

    </main>
</body>

<script>
// Image preview on file select
document.getElementById('imageFileInput')?.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(event) {
            document.getElementById('imagePreview').src = event.target.result;
        };
        reader.readAsDataURL(file);
    }
});

// Image preview on URL input
document.getElementById('imageUrlInput')?.addEventListener('input', function(e) {
    const url = e.target.value;
    if (url) {
        document.getElementById('imagePreview').src = url;
    }
});
</script>